<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
ext_filter() implements Common Query Language (CQL2) filter extension
on rstac. This extension expands the filter capabilities providing a
query language to construct more complex expressions. CQL2 is an OGC
standard and defines how filters can be constructed. It supports predicates
for standard data types like strings, numbers, and boolean as well as
for spatial geometries (point, lines, polygons) and temporal
data (instants and intervals).

cql2_json() and cql2_text() are helper functions that can be used
to show how expressions are converted into CQL2 standard, either
JSON or TEXT formats.
rstac translates R expressions to CQL2, allowing users to express their
filter criteria using R language. For more details on how to create
CQL2 expressions in rstac. See the details section."><title>Filter extension — ext_filter • rstac</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Serif-0.4.4/font.css" rel="stylesheet"><link href="../deps/IBM_Plex_Mono-0.4.4/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter extension — ext_filter"><meta property="og:description" content="
ext_filter() implements Common Query Language (CQL2) filter extension
on rstac. This extension expands the filter capabilities providing a
query language to construct more complex expressions. CQL2 is an OGC
standard and defines how filters can be constructed. It supports predicates
for standard data types like strings, numbers, and boolean as well as
for spatial geometries (point, lines, polygons) and temporal
data (instants and intervals).

cql2_json() and cql2_text() are helper functions that can be used
to show how expressions are converted into CQL2 standard, either
JSON or TEXT formats.
rstac translates R expressions to CQL2, allowing users to express their
filter criteria using R language. For more details on how to create
CQL2 expressions in rstac. See the details section."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rstac</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cql2-example.html">CQL2 examples</a>
    <a class="dropdown-item" href="../articles/cql2-mpc-examples.html">Reading Planetary Computer Data using CQL2 filter extension</a>
    <a class="dropdown-item" href="../articles/rstac-intro.html">Introduction to rstac package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/brazil-data-cube/rstac/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filter extension</h1>
      <small class="dont-index">Source: <a href="https://github.com/brazil-data-cube/rstac/blob/HEAD/R/ext_filter.R" class="external-link"><code>R/ext_filter.R</code></a></small>
      <div class="d-none name"><code>ext_filter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
<code>ext_filter()</code> implements Common Query Language (CQL2) filter extension
on <code>rstac</code>. This extension expands the filter capabilities providing a
query language to construct more complex expressions. CQL2 is an OGC
standard and defines how filters can be constructed. It supports predicates
for standard data types like strings, numbers, and boolean as well as
for spatial geometries (point, lines, polygons) and temporal
data (instants and intervals).</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
<code>cql2_json()</code> and <code>cql2_text()</code> are helper functions that can be used
to show how expressions are converted into CQL2 standard, either
JSON or TEXT formats.</p>
<p><code>rstac</code> translates R expressions to CQL2, allowing users to express their
filter criteria using R language. For more details on how to create
CQL2 expressions in <code>rstac</code>. See the details section.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ext_filter</span><span class="op">(</span><span class="va">q</span>, <span class="va">expr</span>, lang <span class="op">=</span> <span class="cn">NULL</span>, crs <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cql2_json</span><span class="op">(</span><span class="va">expr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cql2_text</span><span class="op">(</span><span class="va">expr</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>q</dt>
<dd><p>a <code>RSTACQuery</code> object expressing a STAC query
criteria.</p></dd>


<dt>expr</dt>
<dd><p>a valid R expression to be translated to CQL2 (see details).</p></dd>


<dt>lang</dt>
<dd><p>a character value indicating which CQL2 representation
to be used. It can be either <code>"cql2-text"</code> (for plain text) or
<code>"cql2-json"</code> (for JSON format). If <code>NULL</code> (default), <code>"cql2-text"</code> is
used for HTTP <code>GET</code> requests and <code>"cql2-json"</code> for <code>POST</code> requests.</p></dd>


<dt>crs</dt>
<dd><p>an optional character value informing the coordinate reference
system used by geometry objects. If <code>NULL</code> (default), STAC services assume
<code>"WGS 84"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>RSTACQuery</code> object  with the subclass <code>ext_filter</code> containing
all request parameters to be passed to <code><a href="request.html">get_request()</a></code> or
<code><a href="request.html">post_request()</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To allow users to express filter criteria in R language, <code>rstac</code> takes
advantage of the abstract syntax tree (AST) to translate R expressions
to CQL2 expressions. The following topics describe the correspondences
between <code>rstac</code> expressions and CQL2 operators.</p><div class="section">
<h3 id="standard-comparison-operators">Standard comparison operators<a class="anchor" aria-label="anchor" href="#standard-comparison-operators"></a></h3>

<ul><li><p><code>==</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&lt;</code>, and <code>!=</code> operators correspond to
<code>=</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&lt;</code>, and <code>&lt;&gt;</code> in CQL2, respectively.</p></li>
<li><p>function <code>is_null(a)</code> and <code>!is_null(a)</code> corresponds to <code>a IS NULL</code> and
<code>a IS NOT NULL</code> CQL2 operators, respectively.</p></li>
</ul></div>

<div class="section">
<h3 id="advanced-comparison-operators">Advanced comparison operators<a class="anchor" aria-label="anchor" href="#advanced-comparison-operators"></a></h3>

<ul><li><p><code>a %like% b</code> corresponds to CQL2 <code>a LIKE b</code>, <code>a</code> and <code>b</code> <code>strings</code> values.</p></li>
<li><p><code>between(a, b, c)</code> corresponds to CQL2 <code>a BETWEEN b AND c</code>, where
<code>b</code> and <code>c</code> <code>integer</code> values.</p></li>
<li><p><code>a %in% b</code> corresponds to CQL2 <code>a IN (b)</code>, where <code>b</code> should be
a list of values of the same type as <code>a</code>.</p></li>
</ul></div>

<div class="section">
<h3 id="spatial-operators">Spatial operators<a class="anchor" aria-label="anchor" href="#spatial-operators"></a></h3>

<ul><li><p>functions <code>s_intersects(a, b)</code>, <code>s_touches(a, b)</code>, <code>s_within(a, b)</code>,
<code>s_overlaps(a, b)</code>, <code>s_crosses(a, b)</code>, and <code>s_contains(a, b)</code> corresponds
to CQL2 <code>S_INTERSECTS(a, b)</code>, <code>S_TOUCHES(a, b)</code>, <code>S_WITHIN(a, b)</code>,
<code>S_OVERLAPS(a, b)</code>, <code>S_CROSSES(a, b)</code>, and <code>S_CONTAINS(a, b)</code> operators,
respectively. Here, <code>a</code> and <code>b</code> should be <code>geometry</code> objects. <code>rstac</code>
accepts <code>sf</code>, <code>sfc</code>, <code>sfg</code>, <code>list</code> (representing GeoJSON objects), or
<code>character</code> (representing either GeoJSON or WKT).</p></li>
<li><p><strong>NOTE</strong>: All of the above spatial object types, except for the
<code>character</code>, representing a WKT, may lose precision due to numeric
truncation when R converts numbers to JSON text. WKT strings are
sent "as is" to the service. Therefore, the only way for users to
retain precision on spatial objects is to represent them as a WKT
string. However, user can control numeric precision using the
<code>options(stac_digits = ...)</code>. The default value is 15 digits.</p></li>
</ul></div>

<div class="section">
<h3 id="temporal-operators">Temporal operators<a class="anchor" aria-label="anchor" href="#temporal-operators"></a></h3>

<ul><li><p>functions <code>date(a)</code>, <code>timestamp(a)</code>, and <code>interval(a, b)</code> corresponds to
CQL2 <code>DATE(a)</code>, <code>TIMESTAMP(a)</code>, and <code>INTERVAL(a, b)</code> operators,
respectively. These functions create literal <code>temporal</code> values.
The first two define an <code>instant</code> type, and the third an <code>interval</code> type.</p></li>
<li><p>functions <code>t_after(a, b)</code>, <code>t_before(a, b)</code>, <code>t_contains(a, b)</code>,
<code>t_disjoint(a, b)</code>, <code>t_during(a, b)</code>, <code>t_equals(a, b)</code>,
<code>t_finishedby(a, b)</code>, <code>t_finishes(a, b)</code>, <code>t_intersects(a, b)</code>,
<code>t_meets(a, b)</code>, <code>t_meet(a, b)</code>, <code>t_metby(a, b)</code>, <code>t_overlappedby(a, b)</code>,
<code>t_overlaps(a, b)</code>, <code>t_startedby(a, b)</code>, and <code>t_starts(a, b)</code> corresponds
to CQL2 <code>T_AFTER(a, b)</code>, <code>T_BEFORE(a, b)</code>, <code>T_CONTAINS(a, b)</code>,
<code>T_DISJOINT(a, b)</code>, <code>T_DURING(a, b)</code>, <code>T_EQUALS(a, b)</code>,
<code>T_FINISHEDBY(a, b)</code>, <code>T_FINISHES(a, b)</code>, <code>T_INTERSECTS(a, b)</code>,
<code>T_MEETS(a, b)</code>, <code>T_MEET(a, b)</code>, <code>T_METBY(a, b)</code>, <code>T_OVERLAPPEDBY(a, b)</code>,
<code>T_OVERLAPS(a, b)</code>, <code>T_STARTEDBY(a, b)</code>, and <code>T_STARTS(a, b)</code> operators,
respectively. Here, <code>a</code> and <code>b</code> are <code>temporal</code> values (<code>instant</code> or
<code>interval</code>, depending on function).</p></li>
</ul></div>

<div class="section">
<h3 id="array-operators">Array Operators<a class="anchor" aria-label="anchor" href="#array-operators"></a></h3>

<ul><li><p>R unnamed lists (or vectors of size &gt; 1) are translated to arrays by
<code>rstac</code>. <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> and <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> functions always create <code>array</code> values
in CQL2 context, no matter the number of its arguments.</p></li>
<li><p>functions <code>a_equals(a, b)</code>, <code>a_contains(a, b)</code>, <code>a_containedby(a, b)</code>,
and <code>a_overlaps(a, b)</code> corresponds to CQL2 <code>A_EQUALS(a, b)</code>,
<code>A_CONTAINS(a, b)</code>, <code>A_CONTAINEDBY(a, b)</code>, and <code>A_OVERLAPS(a, b)</code>
operators, respectively. Here, <code>a</code> and <code>b</code> should be <code>arrays</code>.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The specification states that double-quoted identifiers should be
interpreted as properties. However, the R language does not distinguish
double quote from single quote strings. The right way to represent
double quoted properties in R is to use the escape character (<code>), for example </code>"date"`.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ext_query.html">ext_query()</a></code>, <code><a href="stac_search.html">stac_search()</a></code>, <code><a href="request.html">post_request()</a></code>,
<code><a href="extensions.html">endpoint()</a></code>, <code><a href="extensions.html">before_request()</a></code>,
<code><a href="extensions.html">after_response()</a></code>, <code><a href="extensions.html">content_response()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Standard comparison operators in rstac:</span></span></span>
<span class="r-in"><span><span class="co"># Creating a stac search query</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op">&lt;-</span> <span class="fu">rstac</span><span class="fu">::</span><span class="fu"><a href="stac.html">stac</a></span><span class="op">(</span><span class="st">"https://planetarycomputer.microsoft.com/api/stac/v1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">rstac</span><span class="fu">::</span><span class="fu"><a href="stac_search.html">stac_search</a></span><span class="op">(</span>limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Equal operator '=' with collection property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"sentinel-2-l2a"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Not equal operator '!=' with collection property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">!=</span> <span class="st">"sentinel-2-l2a"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Less than operator '&lt;' with cloud_cover property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">`eo:cloud_cover`</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Greater than operator '&gt;' with vegetation_percentage property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">`s2:vegetation_percentage`</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Less than or equal operator '&lt;=' with datetime property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">datetime</span> <span class="op">&lt;=</span> <span class="st">"1986-01-01"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Greater than or equal '&gt;=' with AND operator</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"sentinel-2-l2a"</span>   <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>                   <span class="va">`s2:vegetation_percentage`</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>                   <span class="va">`eo:cloud_cover`</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Advanced comparison operators</span></span></span>
<span class="r-in"><span><span class="co"># 'LIKE' operator</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">%like%</span> <span class="st">"modis%"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'IN' operator</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">collection</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"landsat-c2-l2"</span>, <span class="st">"sentinel-2-l2a"</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="va">datetime</span> <span class="op">&gt;</span> <span class="st">"2019-01-01"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="va">datetime</span> <span class="op">&lt;</span> <span class="st">"2019-06-01"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial operator</span></span></span>
<span class="r-in"><span><span class="co"># Lets create a polygon with list</span></span></span>
<span class="r-in"><span><span class="va">polygon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"Polygon"</span>,</span></span>
<span class="r-in"><span>  coordinates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">62.34499836</span>, <span class="op">-</span><span class="fl">8.57414572</span>,</span></span>
<span class="r-in"><span>             <span class="op">-</span><span class="fl">62.18858174</span>, <span class="op">-</span><span class="fl">8.57414572</span>,</span></span>
<span class="r-in"><span>             <span class="op">-</span><span class="fl">62.18858174</span>, <span class="op">-</span><span class="fl">8.15351185</span>,</span></span>
<span class="r-in"><span>             <span class="op">-</span><span class="fl">62.34499836</span>, <span class="op">-</span><span class="fl">8.15351185</span>,</span></span>
<span class="r-in"><span>             <span class="op">-</span><span class="fl">62.34499836</span>, <span class="op">-</span><span class="fl">8.57414572</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># 'S_INTERSECTS' spatial operator with polygon and geometry property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"sentinel-2-l2a"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>                   <span class="fu">s_intersects</span><span class="op">(</span><span class="va">geometry</span>, <span class="op">{</span><span class="op">{</span><span class="va">polygon</span><span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'S_CONTAINS' spatial operator with point and geometry property</span></span></span>
<span class="r-in"><span><span class="va">point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Point"</span>, coordinates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">62.45792211</span>, <span class="op">-</span><span class="fl">8.61158488</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>                   <span class="fu">s_contains</span><span class="op">(</span><span class="va">geometry</span>, <span class="op">{</span><span class="op">{</span><span class="va">point</span><span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'S_CROSSES' spatial operator with linestring and geometry property</span></span></span>
<span class="r-in"><span><span class="va">linestring</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"LineString"</span>,</span></span>
<span class="r-in"><span>  coordinates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">62.55735320</span>, <span class="op">-</span><span class="fl">8.43329465</span>, <span class="op">-</span><span class="fl">62.21791603</span>, <span class="op">-</span><span class="fl">8.36815014</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>                   <span class="fu">s_crosses</span><span class="op">(</span><span class="va">geometry</span>, <span class="op">{</span><span class="op">{</span><span class="va">linestring</span><span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Temporal operator</span></span></span>
<span class="r-in"><span><span class="co"># 'T_INTERSECTS' temporal operator with datetime property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ext_filter</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu">t_intersects</span><span class="op">(</span><span class="va">datetime</span>, <span class="fu">interval</span><span class="op">(</span><span class="st">"1985-07-16T05:32:00Z"</span>,</span></span>
<span class="r-in"><span>                                    <span class="st">"1985-07-24T16:50:35Z"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'T_DURING' temporal operator with datetime property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>            <span class="fu">t_during</span><span class="op">(</span><span class="va">datetime</span>,</span></span>
<span class="r-in"><span>            <span class="fu">interval</span><span class="op">(</span><span class="st">"2022-07-16T05:32:00Z"</span>, <span class="st">".."</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'T_BEFORE' temporal operator with datetime property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>            <span class="fu">t_before</span><span class="op">(</span><span class="va">datetime</span>, <span class="fu"><a href="https://rdrr.io/r/utils/savehistory.html" class="external-link">timestamp</a></span><span class="op">(</span><span class="st">"2022-07-16T05:32:00Z"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'T_AFTER' temporal operator with datetime property</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">ext_filter</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>            <span class="fu">t_after</span><span class="op">(</span><span class="va">datetime</span>, <span class="fu"><a href="https://rdrr.io/r/utils/savehistory.html" class="external-link">timestamp</a></span><span class="op">(</span><span class="st">"2022-07-16T05:32:00Z"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="request.html">post_request</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Shows how CQL2 expression (TEXT format)</span></span></span>
<span class="r-in"><span><span class="fu">cql2_text</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu">s_crosses</span><span class="op">(</span><span class="va">geometry</span>, <span class="op">{</span><span class="op">{</span><span class="va">linestring</span><span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Shows how CQL2 expression (JSON format)</span></span></span>
<span class="r-in"><span><span class="fu">cql2_json</span><span class="op">(</span><span class="va">collection</span> <span class="op">==</span> <span class="st">"landsat-c2-l2"</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>            <span class="fu">t_after</span><span class="op">(</span><span class="va">datetime</span>, <span class="fu"><a href="https://rdrr.io/r/utils/savehistory.html" class="external-link">timestamp</a></span><span class="op">(</span><span class="st">"2022-07-16T05:32:00Z"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rolf Simoes, Felipe Carvalho, Brazil Data Cube Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

